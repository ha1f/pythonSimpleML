#coding: utf-8
import numpy as np
import matplotlib.pyplot as plt
import random

teacherData = [([-1.6987530565122002, 0.16202490513589182, 1], -1), ([2.594239246384247, 0.8566730695844147, 1], 1), ([-1.9476730586519417, 0.6429506667672007, 1], -1), ([-0.8563015115876487, -0.4311272642742792, 1], -1), ([3.4812533807749633, 1.9251728552837943, 1], 1), ([3.8442128233734123, 1.700566761476499, 1], 1), ([-0.04495054097642925, -1.3882525289823833, 1], -1), ([-1.4603868404954188, 0.12587116193269382, 1], -1), ([5.032316894476594, 1.78196561703314, 1], 1), ([-1.355614963551342, 0.08382699304731972, 1], -1), ([3.491987212897291, 1.8609215323696486, 1], 1), ([0.06441441819246616, 0.2963990811435704, 1], -1), ([0.6010771271383993, -0.5338503261064845, 1], -1), ([1.635662102475993, 1.0587739032000298, 1], 1), ([3.2958095430009218, 2.9234240191506418, 1], 1), ([-0.1160223281903203, 0.45359599111074106, 1], -1), ([4.349826960694884, 3.0105626525638387, 1], 1), ([-0.36221533078957724, 0.4435150504571437, 1], -1), ([-1.8622539080769323, 0.13949331039774995, 1], -1), ([2.180765158865464, 1.591746870464482, 1], 1), ([3.239972664714862, 2.3974650613337487, 1], 1), ([3.7166072525787697, 2.2944713061948643, 1], 1), ([0.7106548754936859, 0.7656075868142997, 1], -1), ([3.802276332356296, 1.2078029211099257, 1], 1), ([-1.0523310829414747, 1.070058778095642, 1], -1), ([0.010122874786013652, 0.9833772080898182, 1], -1), ([3.180850743564707, 0.5837943287819167, 1], 1), ([4.235387522256125, 2.084365506529038, 1], 1), ([5.237045995861395, 2.864212661463207, 1], 1), ([5.558112114536874, 1.9081870352913815, 1], 1), ([3.6462675138985188, 3.840679591128496, 1], 1), ([2.061613238837927, 0.43042207873676425, 1], -1), ([0.48268097806332466, -0.6974187737987606, 1], -1), ([-0.17006192955491126, 0.8527187427403637, 1], -1), ([0.8660731717337019, 1.3636865281784536, 1], -1), ([0.7357776871692626, -2.2121034233357983, 1], -1), ([4.549597562126795, 1.9136990675737013, 1], 1), ([1.6562696329747244, 1.9755920846475552, 1], -1), ([3.2632636042885794, 3.2891866621281682, 1], 1), ([4.204207630583571, 1.9347792831989186, 1], 1), ([5.368283247947411, 1.575416742983467, 1], 1), ([-0.8794039279501483, -1.163191096144774, 1], -1), ([3.4743600493474145, 1.7394960131553308, 1], 1), ([3.430971764922564, 2.7397090228185914, 1], 1), ([2.3698325873780153, 0.13147198443076236, 1], 1), ([-0.9434172996286303, 0.2831024923297487, 1], -1), ([-0.6206162027749738, 0.8155013110040092, 1], -1), ([-0.5930761084039261, -0.1861043896540942, 1], -1), ([-0.8975994987345914, -1.8328877740951497, 1], -1), ([0.17100011566450002, -1.8290580222916006, 1], -1), ([3.3669727011683057, 3.271264050107822, 1], 1), ([2.9658538629085784, 2.179249783061247, 1], 1), ([3.561106966956304, 2.577419764216516, 1], 1), ([3.0626077457814462, 2.1873400249063075, 1], 1), ([4.503470172886216, 2.68327741981577, 1], 1), ([4.770928689294979, 1.2449334965154981, 1], 1), ([3.9247966985182856, 2.4775438129569722, 1], 1), ([-0.2812608224785795, 0.47081115521556294, 1], -1), ([-0.9948286393195434, -0.1872614824608764, 1], -1), ([4.120972222566101, 2.421931726575144, 1], 1), ([4.257818888741703, 2.1199625487118574, 1], 1), ([4.975865331451486, 1.6660856291598942, 1], 1), ([-0.6628401953797677, 0.6427602157247954, 1], -1), ([0.4774495824534491, 0.8036583391775074, 1], -1), ([-0.5102730457409367, -0.17395127829989018, 1], -1), ([0.1936025326317021, 1.0234009825072778, 1], -1), ([-0.8320162103505941, 0.0070980875217889075, 1], -1), ([1.7754424132657958, 0.34168134800287486, 1], 1), ([5.150118685906015, 3.4682871113425184, 1], 1), ([3.3113786098635076, 1.8289729751155175, 1], 1), ([3.421571468704513, 0.6843894431084807, 1], 1), ([2.27609804544156, -0.11899699742919474, 1], -1), ([3.429136198873608, 2.2007370230594807, 1], 1), ([-1.7985674090882082, -0.7582922669776043, 1], -1), ([2.798315595174614, 2.0924885455276327, 1], 1), ([3.3410825250767515, 1.9122616154000758, 1], 1), ([4.362502808682884, 2.393092414565783, 1], 1), ([-0.7427812835744427, 0.5540720045572107, 1], -1), ([2.8093567656928062, 1.7042026292955943, 1], 1), ([-1.1896605702508396, -1.9583901933421126, 1], -1), ([2.0950016767186606, -0.44189538559656955, 1], -1), ([5.910449306670594, 1.8625143092245933, 1], 1), ([1.0990459556803664, 0.8779853052827615, 1], -1), ([4.389928471357582, 2.5244886430052706, 1], 1), ([3.0372393062577148, 1.116318863697348, 1], 1), ([3.1542763302033823, 1.7883615510421946, 1], 1), ([3.5665436184091956, 1.1288254830607167, 1], 1), ([-0.6252715726764771, -0.7428645674439043, 1], -1), ([0.1345961735667551, 0.568820629962612, 1], -1), ([0.9596331675709929, -0.13682325458019878, 1], -1), ([-1.4786113083009602, -0.22533478186147515, 1], -1), ([3.9844147310835956, 1.75373156352606, 1], 1), ([0.3052094314174387, -1.4315031293969425, 1], -1), ([2.9822643668814797, 1.1652312252355355, 1], 1), ([0.7798625996353306, 0.35093620078852966, 1], -1), ([4.225589619034015, 1.5960430076487386, 1], 1), ([5.272357890659226, 2.3821618914535336, 1], 1), ([-0.5031967009382114, 0.7827636891389056, 1], -1), ([3.072235010888771, 3.3566777817123934, 1], 1), ([-0.9001451672776213, 0.797520805786071, 1], -1), ([1.3216107851455703, -0.27758645380604907, 1], -1), ([4.615024334286746, 1.9891948754894335, 1], 1), ([3.4063716133783646, 1.9860713748273715, 1], 1), ([3.3821731224040885, 2.8898184224920227, 1], 1), ([2.122487446413564, 1.6247350381850616, 1], 1), ([0.22083510419344873, -0.8702389901115518, 1], -1), ([0.5976330251590608, -0.25716465641896474, 1], -1), ([-0.6388607059379641, 1.0912756522562588, 1], -1), ([0.6775768627295152, -0.2628759611691184, 1], -1), ([3.0363869613145784, 4.79340282630273, 1], 1), ([4.594470863138941, 2.302542626021277, 1], 1), ([1.8394370972696477, 1.8231089187171663, 1], 1), ([4.130393583212723, 0.6150860666942455, 1], 1), ([1.2112452350725769, -0.3218922421452624, 1], -1), ([4.082509115844178, 2.3848400236449923, 1], 1), ([3.5545199099557263, 0.9264430133914503, 1], 1), ([5.256033409455533, 1.8900037605028965, 1], 1), ([-1.0821738900838795, -1.6171825330535012, 1], -1), ([-1.3626951891748063, -1.2537127408751378, 1], -1), ([3.8134358137716102, -0.11551401178887621, 1], 1), ([2.9307846100169312, 2.506582532350949, 1], 1), ([5.231350039742652, 3.136610420667535, 1], 1), ([0.40985904691497177, -1.3292333560717464, 1], -1), ([-0.45010153840054395, -0.02794852303589184, 1], -1), ([-1.2921346782456928, 0.6581950333178634, 1], -1), ([1.1506855832897551, 0.6149844853016709, 1], -1), ([4.858553981529017, 3.4910846185461843, 1], 1), ([3.194365092496509, 1.3421055783853242, 1], 1), ([4.1092332599302726, 2.1349001952652285, 1], 1), ([-0.6675365045888597, -0.44826797842819166, 1], -1), ([0.10954616557874196, 0.45803041803786176, 1], -1), ([4.420802918223683, 3.118697001528645, 1], 1), ([-0.8921957829049462, -1.6144637070772518, 1], -1), ([-0.13795714522493008, -0.2026040639547663, 1], -1), ([0.981317850240463, -0.526097797035662, 1], -1), ([2.454495832400533, 1.7897715538384615, 1], 1), ([5.598292009117669, 1.9442139615574465, 1], 1), ([1.4462281973350821, -0.9491644201298768, 1], -1), ([0.502299411100666, -1.133305823575998, 1], -1), ([3.298641557781471, 1.1065178044166242, 1], 1), ([-0.7094299281029369, 0.7620068284403553, 1], -1), ([-0.7266430112310922, 1.8713082841514659, 1], -1), ([-1.1421358504573575, -0.530466563756216, 1], -1), ([5.319173286676944, 0.4784092920622609, 1], 1), ([3.1321673687349243, 1.8470667037995143, 1], 1), ([-0.05961554783647481, 0.617154499451345, 1], -1), ([4.627073994395866, 1.191448048617497, 1], 1), ([-0.6244405213951133, 1.0040831024184196, 1], -1), ([0.320690406174319, -0.6089813350418487, 1], -1), ([3.384696092614119, 1.294179377156992, 1], 1), ([-0.9944190812078867, -0.3159484184059511, 1], -1), ([0.8014943634316989, 0.2758580806068211, 1], -1), ([3.8714582925707566, 2.4769352229191073, 1], 1), ([3.2423422893354967, 2.8820172737502645, 1], 1), ([-1.6039591814400045, -2.822589776219323, 1], -1), ([3.1769613774692944, 0.42700979721436627, 1], 1), ([-0.846912915298674, -0.5969488292449873, 1], -1), ([3.735433040448283, 0.539743672074692, 1], 1), ([-1.177928227589755, -1.8317002044959507, 1], -1), ([4.565341685904714, 2.0724716933557654, 1], 1), ([4.461873114580578, 1.266124945148305, 1], 1), ([0.7999115639987833, -0.7698296923313737, 1], -1), ([-1.5279570595330656, 0.5552947372077237, 1], -1), ([1.1478641475460079, -1.340089987093045, 1], -1), ([0.9382586832932777, 1.3766233168415123, 1], -1), ([-1.0806211191380584, 0.669423555584404, 1], -1), ([2.986852260694832, 0.38015695515630354, 1], 1), ([-0.5438885198467155, 1.3245467407386318, 1], -1), ([0.29482453369608597, -0.19850962373762576, 1], -1), ([-1.1475948868982366, -0.6993263232742466, 1], -1), ([-1.1386680104794786, 0.03941091811714262, 1], -1), ([-0.4254548809185399, 1.2141840265686934, 1], -1), ([6.3344200861124165, 2.488642264814734, 1], 1), ([0.11520864526518415, -1.1655056296342101, 1], -1), ([2.8561099381062203, 1.3824587241436044, 1], 1), ([2.6708037044920845, 1.6532982078661056, 1], 1), ([4.49037048081113, 3.4232889462113114, 1], 1), ([1.5874794587340455, -1.6954806254698918, 1], -1), ([-0.06281264932047187, 1.297331567893582, 1], -1), ([2.3338838329800167, 2.5522692864756173, 1], 1), ([1.3135397832437417, 0.6685877950912648, 1], -1), ([3.268885269455778, 1.4940270959506563, 1], 1), ([4.572079242287993, 0.8111849452994351, 1], 1), ([0.07583414093987363, -0.9684183134241043, 1], -1), ([-0.34472612300577266, 0.3086920040166927, 1], -1), ([3.9204181382952306, 3.788541443771421, 1], 1), ([0.669632291759536, 0.03380308194920748, 1], -1), ([-0.3946419220883294, 0.31576043474629806, 1], -1), ([2.4235139866369, 2.0205616104326576, 1], 1), ([-1.0117544996079584, 0.41454121763624585, 1], -1), ([-0.6423009332833739, -1.6949284244881513, 1], -1), ([3.027755330535702, 2.661810281608224, 1], 1), ([4.938561272951795, 1.0284268170719475, 1], 1), ([4.694440845292638, -0.748146847364497, 1], 1), ([-0.5991106555643663, -1.4184915980506994, 1], -1), ([0.986757927686407, -1.555249632363833, 1], -1), ([4.983695170209223, 2.558966959916349, 1], 1), ([1.5924722310955444, 0.1897029153512252, 1], -1), ([-0.4378079973033154, -0.4414662525089108, 1], -1), ([0.7557521911154933, 1.6728610204751073, 1], -1), ([2.697650319399689, 2.144839301742471, 1], 1), ([3.208489112590137, 2.041742392428566, 1], 1), ([0.10320509509611737, 1.1015587659988386, 1], -1), ([1.6157112105651779, -0.1323421704031012, 1], -1), ([-0.36143466853294787, -0.4108705012235957, 1], -1), ([4.3727120471673295, 0.581576506365018, 1], 1), ([-1.7103522113629994, 0.09444733666081406, 1], -1), ([3.437338728078428, 0.9200635558935983, 1], 1), ([-1.3994627610205272, -0.5194642087370437, 1], -1), ([4.262597098487844, 2.6743917338813867, 1], 1), ([3.8493043246658973, 2.4481162209606384, 1], 1), ([2.9953367301737313, 1.3018784334772866, 1], 1), ([-0.1939145788866394, 0.5108839844626812, 1], -1), ([4.668424013984106, 0.2532477167504801, 1], 1), ([-0.22485870339362016, 1.2000690932891578, 1], -1), ([5.195085542272987, 1.7638100937406165, 1], 1), ([3.544898637939787, 1.3111575922327172, 1], 1), ([5.908415268599219, 1.4012229964458731, 1], 1), ([-0.5249057115042893, -0.8797090643016319, 1], -1), ([3.9741119259560915, 2.7699883201986655, 1], 1), ([2.4980712900572994, 1.7860399482047398, 1], 1), ([5.302770639222412, 3.3568232594678262, 1], 1), ([3.53493646780494, 2.709116312354786, 1], 1), ([-0.6516360067070558, 1.4105740301389036, 1], -1), ([5.491302356069333, 3.2114781002557864, 1], 1), ([4.271588987143782, 3.4372353794352017, 1], 1), ([4.911421201199237, 2.9265049874895728, 1], 1), ([4.972097052916237, 2.1460772654261095, 1], 1), ([3.469519143329331, 3.4240582912835285, 1], 1), ([-0.9093348676484271, -1.0276476631270017, 1], -1), ([0.005380716964860568, -0.47325187630478777, 1], -1), ([4.290877133008939, 2.76406060995508, 1], 1), ([0.04037640705551934, -1.8384584465349156, 1], -1), ([-2.1918269144990226, 1.6771674571716177, 1], -1), ([5.07804174761167, 1.0729711759254643, 1], 1), ([-1.7581020185712901, 0.6060751649555887, 1], -1), ([5.113127526603986, 3.103133875604555, 1], 1), ([5.234181906276549, 1.8770839181904626, 1], 1), ([3.893100818221279, 0.07605173238892182, 1], 1), ([4.090481155824165, 0.5266606161435052, 1], 1), ([1.2555333734124827, -1.8861325559281663, 1], -1), ([6.399285416084343, 2.2768607847627234, 1], 1), ([1.1085712261208704, 0.44405491629925997, 1], -1), ([-0.008297737695220287, 1.7300861265094063, 1], -1), ([0.24438336739168842, 2.3016406608140945, 1], -1), ([6.110008782747255, 2.7159531825293017, 1], 1), ([-0.6755864536950478, 1.2179892001742598, 1], -1), ([5.992658338254092, 1.3593723816204935, 1], 1), ([-1.6652652615246861, 0.4808605693066719, 1], -1), ([0.35495236429979415, -1.622395284195899, 1], -1), ([4.461607734295668, 2.117742737067785, 1], 1), ([-0.08684469072526992, -0.2201246009985799, 1], -1), ([4.825130632872572, 2.3151436396298495, 1], 1), ([5.141719626641457, 2.7228913486961464, 1], 1), ([3.626183896557838, 0.10646203711250468, 1], 1), ([1.2139120348789485, -0.6952622545504048, 1], -1), ([3.363272032881268, 2.347506592056588, 1], 1), ([3.7286709274229066, 2.657135076115447, 1], 1), ([0.8910745084769508, -0.06198141541330733, 1], -1), ([0.34721332486598344, -0.7722524453542179, 1], -1), ([-0.11185532722261983, -0.2910278229974921, 1], -1), ([-1.091688764843881, -0.7266373202998551, 1], -1), ([3.017275010969484, 0.9735530325842232, 1], 1), ([0.05672759303124987, 1.3262087440768238, 1], -1), ([3.073056949355265, 2.528979424178488, 1], 1), ([0.6442027419034375, 0.11164424816691348, 1], -1), ([1.4129716966560963, -1.4746546893107182, 1], -1), ([-0.6330678487494571, -0.7203296903323513, 1], -1), ([4.840336983259549, 1.9260327279975225, 1], 1), ([5.101650515135222, 1.1311467803391961, 1], 1), ([0.6812327343307006, 0.8051569125032702, 1], -1), ([-0.23357714255734177, 1.394058977842852, 1], -1), ([0.01897010318299866, 0.07373985569443435, 1], -1), ([-0.786880198493842, -1.4162381700413735, 1], -1), ([-0.6257854972196261, -0.2623386478159515, 1], -1), ([4.7039370787679635, 1.8204134642666632, 1], 1), ([-0.448538792918922, -0.3201644809156678, 1], -1), ([3.4711176399699335, 2.2802748636526213, 1], 1), ([-1.6213274171486691, 0.8668303620668416, 1], -1), ([-1.5270469274370893, 1.1186197506034468, 1], -1), ([0.798710980297203, 1.6411824655974463, 1], -1), ([-0.13293528979721367, 1.0841781237089134, 1], -1), ([2.9642762964139036, 1.2815183996749608, 1], 1), ([0.02140119846376513, -1.1870826198069147, 1], -1), ([4.3013539029803765, 2.629982970593353, 1], 1), ([2.659059144922784, 2.1039598073729495, 1], 1), ([0.49031928718096357, -0.5539320365828925, 1], -1), ([4.906115262720843, 0.7315246936400586, 1], 1), ([-0.6607356471243613, 0.3858583412384549, 1], -1), ([3.1682890656168152, 1.9254012292737626, 1], 1), ([-0.664644237339482, -1.4419089441530288, 1], -1), ([0.55177168113055, -1.9186999786880163, 1], -1), ([1.0338691844802252, 0.8544439267701409, 1], -1), ([-0.04700112644449866, 0.1288900227818519, 1], -1), ([0.44714960150696903, 1.1992500049713792, 1], -1), ([-0.37366228943867685, 0.5408517207466568, 1], -1), ([4.105227392422989, 1.6772249247343585, 1], 1), ([3.2576167534046383, 2.633715345375036, 1], 1), ([0.3678233500255769, 0.3825808539646566, 1], -1), ([4.391786897408584, 0.9919046868205679, 1], 1), ([4.812816882924183, 1.079168655553923, 1], 1), ([3.468514314915415, 1.9946600564024066, 1], 1), ([3.7322195071361874, 0.1691101153886525, 1], 1), ([-0.7424013432827237, 0.8056578501430599, 1], -1), ([3.8358134291761887, 1.5108800309594397, 1], 1), ([3.4921900165523105, 1.213788177170008, 1], 1), ([0.5107550745113401, -0.45253971339318544, 1], -1), ([0.08065735611688174, -0.13276612891963585, 1], -1), ([2.306027057724468, 1.7364763373886443, 1], 1), ([4.426322911396129, 1.756477379805003, 1], 1), ([-0.45440095465579866, -0.7141283260389176, 1], -1), ([-1.028445186321725, -0.008052586968483195, 1], -1), ([3.9590227918132483, 1.1067828610117671, 1], 1), ([2.5485615866339684, 2.2494672489951038, 1], 1), ([3.4685273889330155, 1.822266780042593, 1], 1), ([4.245383828709408, 2.5230780930635914, 1], 1), ([3.7712801563180736, 3.0142283610496268, 1], 1), ([0.6995305924207185, 0.9757194134431943, 1], -1), ([-2.9792612419505047, -0.7184482786842787, 1], -1), ([1.5441073877896547, -0.3678167005979007, 1], -1), ([4.72039547697807, 0.5812193762455145, 1], 1), ([-1.2220507767222435, 0.06658580026586776, 1], -1), ([0.37793450183095867, -0.12023689173613579, 1], -1), ([2.9828244291881694, 0.46215100725847336, 1], 1), ([-0.9232417375444849, -1.679584137558991, 1], -1), ([1.59935378188123, 0.017861170373225373, 1], -1), ([0.9883101130980049, -0.9102120432807841, 1], -1), ([4.7978884661001135, 2.0361794917350804, 1], 1), ([2.981301625570094, 2.3684190496058584, 1], 1), ([-1.0733297970032256, 1.4717475383869543, 1], -1), ([4.417431502961316, 0.4295730395314503, 1], 1), ([4.793587727044171, 1.940600953313086, 1], 1), ([2.5872707244164723, 0.6407823187242971, 1], 1), ([3.8737982561575435, 2.055262512452444, 1], 1), ([3.351263107968191, 2.351735402099411, 1], 1), ([3.1181207936057938, 1.8068268339729503, 1], 1), ([5.6671665211782924, -0.5030178338420028, 1], 1), ([4.199811394164904, 1.661153280935576, 1], 1), ([3.664489666030625, 0.20957232583543228, 1], 1), ([3.088920991505624, 3.8381917525495295, 1], 1), ([0.9812490651278672, 2.4452559677440187, 1], -1), ([1.1629773954706895, 0.3662435787570597, 1], -1), ([-0.6615731901559758, -0.14279079714850756, 1], -1), ([3.3484916774976643, 2.242006717505547, 1], 1), ([4.720287481946692, 1.629049830039269, 1], 1), ([0.19389598693007348, -0.2858381354293949, 1], -1), ([6.306357173071708, 1.8641624823165655, 1], 1), ([4.782073195905086, 3.637124007298566, 1], 1), ([-0.9400684114284279, -0.28337628724619024, 1], -1), ([5.190623361173012, 0.9710618180565833, 1], 1), ([-0.36017039651087884, 0.5294496114047721, 1], -1), ([3.2883227192831326, 1.9106215461556562, 1], 1), ([3.6815327158243836, 2.9725065037122853, 1], 1), ([4.530998093543849, 2.032779207762893, 1], 1), ([4.968773658815055, 2.7559507755004238, 1], 1), ([-0.601246039300988, 0.05029849147985486, 1], -1), ([4.431244263764988, 2.2295547396967073, 1], 1), ([2.5366497111335997, 1.7383288051174577, 1], 1), ([-0.14137474077072593, 0.8692029298084334, 1], -1), ([-1.1263187144079712, 0.19550911331448007, 1], -1), ([0.198434093635478, -0.9670815366801169, 1], -1), ([-1.061587480834987, -0.8239386708676162, 1], -1), ([0.6903220519034008, 0.928765746567245, 1], -1), ([0.9310044310335638, -0.25192893847653375, 1], -1), ([-0.4755263241932968, -0.6537159583501391, 1], -1), ([2.2188661530536944, 3.0292687898689836, 1], 1), ([2.5152896034573615, 3.0867562494973946, 1], 1), ([-0.3382764259180713, 1.0290713832373597, 1], -1), ([2.056004690534735, 2.60118045720732, 1], 1), ([5.3098160545430675, 2.424114339508878, 1], 1), ([0.3379362806842664, 1.3860226714334696, 1], -1), ([5.089374845024154, 1.7437801719523973, 1], 1), ([-1.1534683595846518, -1.9387312094625773, 1], -1), ([0.37867420868471335, -1.0971820731841104, 1], -1), ([-0.9377882169205684, 0.41670799165862554, 1], -1), ([4.504518216467452, 2.8771048338405065, 1], 1), ([3.686374603639652, 3.2791842866570784, 1], 1), ([-0.2364237632224492, 0.5926096519342587, 1], -1), ([1.3857019988018382, -1.5303586546447667, 1], -1), ([2.1976731129785634, 3.4117487059073826, 1], 1), ([0.19998907080608447, -0.4549828302639899, 1], -1), ([-0.6770982372366284, 1.0218410459147356, 1], -1), ([-1.0074476747617793, -1.8404634222518164, 1], -1), ([3.888069922129568, 2.489330282912446, 1], 1), ([0.6371247349613068, -0.9046747622818557, 1], -1), ([0.5903219688774237, 0.309141373080977, 1], -1), ([0.31131124669622173, 0.5418297869879058, 1], -1), ([5.107920924936512, 1.964070567894905, 1], 1), ([0.6044968352462474, 1.2519298068244384, 1], -1), ([0.857983584749155, 1.5187327002265256, 1], -1), ([0.09880799363267628, 0.059056703510199524, 1], -1), ([-0.5434964201757333, 0.616919249644555, 1], -1), ([3.081828699881413, 2.221948748051644, 1], 1), ([3.478168667577704, 2.465231288229433, 1], 1), ([3.5985400905933482, 1.8308664157455705, 1], 1), ([0.3059789147156317, 1.7614661641773923, 1], -1), ([1.3496585071681424, 1.4096482155285162, 1], 1), ([-0.6647184891701927, 0.14986068154806365, 1], -1), ([3.54034337221535, 1.1070756036656342, 1], 1), ([4.647249613175661, 0.5441257662537167, 1], 1)]
random.shuffle(teacherData)

class Perceptron:
    # out = ax + by + c
    params=[]

    # 出力の重み関数
    weight = staticmethod(lambda x: (1 if x>0 else -1))

    # 学習係数
    lamda = 0.01

    #y = -a/b*x - c/b
    getY = lambda self,x: (- self.params[0]/self.params[1]*x - self.params[2]/self.params[1])

    def __init__(self, params):
        self.params = params

    def getOutput(self, inputData):
        return Perceptron.weight(sum([i*j for i,j in zip(inputData, self.params[0:len(inputData)])]))

    def learn(self, teacherIn, teacherOut):
        # とりあえず差はそのままの差
        diff = teacherOut - self.getOutput(teacherIn)
        for i in range(0, len(teacherIn)):
            self.params[i] += self.lamda * diff * teacherIn[i]

    # 現在の境界をplot
    def plotBoundary(self, style, width):
        xArray = lambda minVal, maxVal, dx: [minVal + dx*i for i in range(0, int((maxVal-minVal)/dx)+1)]
        xs = xArray(-4,8,0.1)
        ys = map(self.getY, xs)
        plt.plot(xs, ys, style,linewidth=width)

def main():
    # 初期化
    perceptron = Perceptron([random.uniform(-0.1,0.1), random.uniform(-0.1,0.1), random.uniform(-0.1,0.1)])

    # 学習フェーズ
    for epoc in range(0,200):
        if (epoc%10) == 0:
            perceptron.plotBoundary("y-", 1)

        for teacherIn, teacherOut in teacherData:
            perceptron.learn(teacherIn, teacherOut)

    # 確認フェーズ
    cCount = 0
    count = 0
    for teacherIn, teacherOut in teacherData:
        plt.plot(teacherIn[0],teacherIn[1], ("ro" if teacherOut < 0 else "go"))
        diff = teacherOut-perceptron.getOutput(teacherIn)
        if diff == 0:
            cCount += 1
        count += 1
    print("accuracy:" +str(cCount) + "/" + str(count) + " = " + str(100.0 * cCount/count) + "%")

    # 結果
    perceptron.plotBoundary("b-",3)

    plt.xlim(-4, 8)
    plt.ylim(-4, 7)
    plt.show()

main()
